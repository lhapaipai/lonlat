export const metadata = {
  title: 'RLayer',
  description: 'wrapper for the layer object'
};

# RLayer

## Usage

```tsx
import { RMap, RSource, RLayer } from "maplibre-react-components";

const townPaintStyle = {
  "fill-outline-color": "rgba(0,0,0,0.1)",
  "fill-color": "rgba(255,0,0,0.3)",
};

export default function App() {
  return (
    <RMap>
      <RSource id="thyez" type="geojson" data="/data/thyez.geojson" />
      <RLayer
        source="thyez"
        id="thyez-fill"
        type="fill"
        paint={townPaintStyle}
      />
    </RMap>
  );
};
```

## Reference

`RLayer` accept same props as `Layer` options plus `beforeId`.

```tsx
type LayerOptions = LayerSpecification | CustomLayerInterface;

type RLayerProps = LayerOptions & {
  beforeId?: string;
};
```

## Reactivity

Some props are responsive, it depends on the layer type.

### `layout`, `paint` props

This 2 props are deeply reactives. However, be careful to define stable objects to avoid multiplying renderings.

```tsx
export default function App() {
  const [red, setRed] = useState(false);

  const townPaintStyle = useMemo(() => ({
    "fill-outline-color": "rgba(0,0,0,0.1)",
    "fill-color": red ? "rgba(255,0,0,0.3)" : "rgba(0,0,0,0.3)",
  }), [red])

  return (
    <>
      <RMap>
        <RSource id="thyez" type="geojson" data="/data/thyez.geojson" />
        <RLayer
          source="thyez"
          id="thyez-fill"
          type="fill"
          paint={townPaintStyle}
        />
      </RMap>
      <div className="sidebar">
        <div>
          <button onClick={() => setRed((r) => !r)}>
            {red ? "set gray" : "set red"}
          </button>
        </div>
      </div>
    </>
  );
};
```

### `filter` prop

This prop is reactive. Be careful to define stable object (or outside component) to avoid multiplying renderings.

### `beforeId`, `minzoom`, `maxzoom`

This props are reactive.


## `key` vs `id`

When you have conditional renderers within your `RMap` component you will need to set the prop `key` for your `RLayer` to help React maintain its association with the correct component.

Consider `id` for `maplibre` mapping and `key` for React mapping.

Note: if `maplibre-react-components` detects a mapping error it will throw an exception.

```tsx
const cityLinePaintStyle = {
  "line-color": "#ffe64b",
  "line-width": 5,
}

const cityFillPaintStyle = {
  "fill-outline-color": "rgba(0,0,0,0.1)",
  "fill-color": "rgba(255,0,0,0.3)",
};

export default function App() {
  const [showStroke, setShowStroke] = useState(false);

  return (
    <>
      <RMap>
        <RSource
          key="city"
          id="city"
          type="geojson"
          data="/data/city.geojson"
        />
        {showStroke && (
          <RLayer
            key="city-line"
            id="city-line"
            source="city"
            type="line"
            paint={cityLinePaintStyle}
          />
        )}
        <RLayer
          key="city-fill"
          id="city-fill"
          source="city"
          type="fill"
          paint={cityFillPaintStyle}
        />
      </RMap>
      <div className="sidebar">
        <div>
          <button onClick={() => setShowStroke((s) => !s)}>
            {showStroke ? "hide city stroke" : "show city stroke"}
          </button>
        </div>
      </div>
    </>

  );
};
```
